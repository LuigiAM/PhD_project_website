---
import Layout from '../layouts/Layout.astro';
import ShareButtons from '../components/ShareButtons.astro';

const cards = [
  {
    id: 'research',
    title: 'For Researchers & Builders',
    tagline: 'Help build the future of emotion monitoring for mental health',
    bullets: [
      'Academic collaboration on emotion recognition algorithms',
      'Collaborations for scientific publications on co-design methodology, digital mental health tools, affective computing',
      'Exploring startup opportunities with technical co-founders',
      'Open to joint grant applications (NIHR, EU Horizon, etc.)'
    ],
    cta: 'Let\'s discuss collaboration',
    ctaLink: 'mailto:hello@luigimoretti.com?subject=Research Collaboration Inquiry',
    imagePlaceholder: 'co-design-tools.jpg'
  },
  {
    id: 'funding',
    title: 'For Investors & Grant Bodies',
    tagline: 'Back the next generation of mental health technology, moving from research to real-world deployment',
    bullets: [
      '£4,500+ secured from NHS and UWE Bristol to date',
      '87+ participants across 5 co-design phases, strong engagement metrics',
      'Building advanced prototypes for both patient and clinician interfaces',
      'Designed for integration in clinical pathways'
    ],
    cta: 'Explore funding opportunities',
    ctaLink: 'mailto:hello@luigimoretti.com?subject=Funding & Support Inquiry',
    imagePlaceholder: 'achievements-chart.jpg'
  },
  {
    id: 'industry',
    title: 'For Product & R&D Teams',
    tagline: 'Discover how emotion detection can create meaningful impact in wearable health products',
    bullets: [
      'Real-world validation of emotion monitoring in consumer wearables (Google Pixel Watch 2)',
      'Expertise bridging clinical research, user-centered design, and technical implementation',
      'Deep understanding of clinical and user needs for health features',
      'Available Fall 2026 for research scientist, PM, or applied ML roles'
    ],
    cta: 'Let\'s connect',
    ctaLink: 'mailto:hello@luigimoretti.com?subject=Industry Opportunity Discussion',
    imagePlaceholder: 'pixel-watch-demo.jpg'
  }
];
---

<Layout
  title="Collaborate - MEMoPAD Project"
  description="Explore collaboration opportunities in emotion monitoring research, funding partnerships, and industry roles with Luigi A. Moretti. Graduating Fall 2026."
>
  <section class="container page-hero">
    <h1>Let's Work Together</h1>
    <p class="hero-intro">
      I'm wrapping up my PhD at UWE Bristol (Fall 2026) and exploring what's next. Whether you're interested in collaborating on research, supporting MEMoPAD's growth, or discussing how emotion monitoring can impact how we deal with mental health, I'd love to connect.
    </p>
    
    <p class="achievements-link">
      <a href="/achievements/">View project milestones & track record →</a>
    </p>

  </section>

  <section class="container carousel-section">
    <div class="carousel-container" data-work-carousel>
      <!-- Tab Navigation -->
      <nav class="carousel-tabs" aria-label="Opportunity Categories">
        <div class="tabs-track">
          {cards.map((card, index) => (
            <button 
              class="carousel-tab" 
              type="button" 
              data-index={index}
              aria-expanded={index === 0 ? "true" : "false"}
            >
              {card.title}
            </button>
          ))}
        </div>
      </nav>

      <!-- Carousel -->
      <div class="carousel-outer">
        <button class="carousel-arrow prev" aria-label="Previous option">&lt;</button>
        <button class="carousel-arrow next" aria-label="Next option">&gt;</button>

        <div class="carousel-viewport">
          <div class="carousel-track">
            {cards.map(card => (
              <div class="carousel-slide">
                <article class="opportunity-card">
                  <div class="card-image">
                    <img 
                      src={`/${card.imagePlaceholder}`} 
                      alt={`Visual representation of ${card.title}`}
                      loading="lazy"
                    />
                  </div>
                  <div class="card-content">
                    <h2>{card.title}</h2>
                    <p class="card-tagline">{card.tagline}</p>
                    <ul class="card-bullets">
                      {card.bullets.map(bullet => <li>{bullet}</li>)}
                    </ul>
                    
                    <!-- Testimonial (commented out until you have permission)
                    <blockquote class="card-testimonial">
                      "Testimonial text here" — Attribution
                    </blockquote>
                    -->
                    
                    <a href={card.ctaLink} class="card-cta button">
                      {card.cta}
                    </a>
                  </div>
                </article>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="container contact-section">
    <h2>Prefer a different approach?</h2>
    <p>You can also reach me directly at <a href="mailto:hello@luigimoretti.com">hello@luigimoretti.com</a> or connect on <a href="https://www.linkedin.com/in/luigiandreamoretti/" target="_blank" rel="noopener noreferrer">LinkedIn</a>.</p>
  </section>

  <ShareButtons 
    pageTitle="Work With Me - MEMoPAD Project"
    shareDescription="Explore collaboration opportunities in emotion monitoring for mental health with Luigi A. Moretti, PhD candidate at UWE Bristol."
  />
</Layout>

<script>
  const initWorkCarousel = (container: HTMLElement) => {
    const tabsContainer = container.querySelector<HTMLElement>('.carousel-tabs');
    const tabs = Array.from(container.querySelectorAll<HTMLButtonElement>('.carousel-tab'));
    const track = container.querySelector<HTMLElement>('.carousel-track');
    const slides = Array.from(container.querySelectorAll<HTMLElement>('.carousel-slide'));
    const prevButton = container.querySelector<HTMLButtonElement>('.carousel-arrow.prev');
    const nextButton = container.querySelector<HTMLButtonElement>('.carousel-arrow.next');
    
    if (!tabsContainer || !track || slides.length === 0 || !prevButton || !nextButton) return;
    
    let currentIndex = 0;
    
    const goToSlide = (index: number) => {
      if (index < 0 || index >= slides.length) return;
      
      track.style.transform = `translateX(-${index * 100}%)`;
      
      tabs.forEach((tab, i) => {
        tab.setAttribute('aria-expanded', (i === index).toString());
      });
      
      const activeTab = tabs[index];
      if (activeTab) {
        const scrollOffset = activeTab.offsetLeft + (activeTab.offsetWidth / 2) - (tabsContainer.offsetWidth / 2);
        tabsContainer.scrollTo({ left: scrollOffset, behavior: 'smooth' });
      }
      
      currentIndex = index;
    };
    
    tabs.forEach(tab => {
      tab.addEventListener('click', () => goToSlide(parseInt(tab.dataset.index || '0')));
    });
    
    prevButton.addEventListener('click', () => {
      const prevIndex = (currentIndex - 1 + slides.length) % slides.length;
      goToSlide(prevIndex);
    });
    
    nextButton.addEventListener('click', () => {
      const nextIndex = (currentIndex + 1) % slides.length;
      goToSlide(nextIndex);
    });
    
    let touchstartX = 0;
    track.addEventListener('touchstart', (e: TouchEvent) => {
      touchstartX = e.changedTouches[0].screenX;
    }, { passive: true });
    
    track.addEventListener('touchend', (e: TouchEvent) => {
      const touchendX = e.changedTouches[0].screenX;
      if (touchendX < touchstartX - 50) nextButton.click();
      if (touchendX > touchstartX + 50) prevButton.click();
    });
    
    goToSlide(0);
  };
  
  document.querySelectorAll<HTMLElement>('[data-work-carousel]').forEach(initWorkCarousel);
</script>

<style>
  .page-hero {
    text-align: center;
    padding-top: 4rem;
    padding-bottom: 2rem;
  }
  
  .page-hero h1 {
    font-size: 3rem;
    margin-bottom: 1.5rem;
  }
  
  .hero-intro {
    font-size: 1.25rem;
    line-height: 1.7;
    color: var(--color-text-muted);
    max-width: 700px;
    margin: 0 auto;
  }

  .achievements-link {
    text-align: center;
    margin-top: 1rem;
  }

  .achievements-link a {
    color: var(--color-primary);
    font-weight: 700;
    text-decoration: none;
    font-size: 1.1rem;
  }

  .achievements-link a:hover {
    text-decoration: underline;
  }

  /* Carousel Structure */
  .carousel-section {
    padding-top: 3rem;
    padding-bottom: 3rem;
  }

  .carousel-container {
    position: relative;
    padding: 2rem 0;
  }

  /* Tab Navigation */
  .carousel-tabs {
    display: flex;
    justify-content: flex-start;
    position: relative;
    border-bottom: 1px solid var(--color-border);
    overflow-x: auto;
    scroll-behavior: smooth;
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .carousel-tabs::-webkit-scrollbar {
    display: none;
  }

  .tabs-track {
    display: flex;
    gap: 1rem;
    padding-bottom: 2rem;
    margin: 0 auto;
  }

  .carousel-tab {
    background: none;
    border: none;
    padding: 0.75rem 1.5rem;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
    position: relative;
    top: 0;
    transition: all 0.3s ease;
    color: var(--color-text-muted);
    white-space: nowrap;
  }

  .carousel-tab[aria-expanded="true"] {
    color: var(--color-primary);
    transform: translateY(6px);
  }

  .carousel-tab[aria-expanded="true"]::after {
    content: '';
    position: absolute;
    bottom: -13px;
    left: 0;
    right: 0;
    height: 4px;
    background-color: var(--color-primary);
  }

  /* Carousel Viewport */
  .carousel-outer {
    position: relative;
    margin-top: 2rem;
  }

  .carousel-viewport {
    width: 100%;
    overflow: hidden;
  }

  .carousel-track {
    display: flex;
    transition: transform 0.5s cubic-bezier(0.86, 0, 0.07, 1);
  }

  .carousel-slide {
    width: 100%;
    flex-shrink: 0;
    padding: 0 1rem;
  }

  /* Arrows */
  .carousel-arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
    background-color: rgba(255, 255, 255, 0.95);
    border: 1px solid var(--color-border);
    border-radius: 50%;
    width: 44px;
    height: 44px;
    cursor: pointer;
    font-size: 1.5rem;
    transition: all 0.2s ease;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }

  .carousel-arrow:hover {
    background-color: var(--color-primary);
    color: var(--color-white);
    border-color: var(--color-primary);
  }

  .carousel-arrow.prev {
    left: -22px;
  }

  .carousel-arrow.next {
    right: -22px;
  }

  /* Card Styling */
  .opportunity-card {
    background-color: var(--color-white);
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    max-width: 700px;
    margin: 0 auto;
  }

  .card-image {
    width: 100%;
    height: 280px;
    overflow: hidden;
    background-color: var(--color-background);
  }

  .card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .card-content {
    padding: 2.5rem;
  }

  .card-content h2 {
    font-size: 2rem;
    margin-bottom: 1rem;
    color: var(--color-primary);
  }

  .card-tagline {
    font-size: 1.15rem;
    line-height: 1.6;
    color: var(--color-text-muted);
    margin-bottom: 2rem;
  }

  .card-bullets {
    list-style: none;
    padding: 0;
    margin: 0 0 2.5rem 0;
  }

  .card-bullets li {
    padding-left: 1.75rem;
    margin-bottom: 1rem;
    position: relative;
    line-height: 1.6;
    color: var(--color-text);
  }

  .card-bullets li::before {
    content: '✓';
    position: absolute;
    left: 0;
    color: var(--color-primary);
    font-weight: 700;
    font-size: 1.2rem;
  }

  .card-testimonial {
    font-style: italic;
    color: var(--color-text-muted);
    border-left: 3px solid var(--color-primary);
    padding-left: 1rem;
    margin: 2rem 0;
    font-size: 1rem;
  }

  .card-cta {
    display: inline-block;
    background-color: var(--color-primary);
    color: var(--color-white);
    padding: 1rem 2rem;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 700;
    font-size: 1.1rem;
    transition: all 0.2s ease;
  }

  .card-cta:hover {
    background-color: var(--color-text);
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  }

  /* Contact Section */
  .contact-section {
    text-align: center;
    padding-top: 3rem;
    padding-bottom: 2rem;
    border-top: 1px solid var(--color-border);
  }

  .contact-section h2 {
    font-size: 2rem;
    margin-bottom: 1rem;
  }

  .contact-section p {
    font-size: 1.125rem;
    color: var(--color-text-muted);
    margin-bottom: 1rem;
  }

  .contact-section a {
    color: var(--color-primary);
    font-weight: 700;
    text-decoration: none;
  }

  .contact-section a:hover {
    text-decoration: underline;
  }

  /* Mobile Adjustments */
  @media (max-width: 768px) {
    .page-hero h1 {
      font-size: 2.5rem;
    }
    
    .carousel-arrow {
      display: none;
    }
    
    .carousel-slide {
      padding: 0;
    }

    .card-content {
      padding: 2rem;
    }

    .card-content h2 {
      font-size: 1.75rem;
    }
  }
</style>