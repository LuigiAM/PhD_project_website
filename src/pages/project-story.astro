---
import Layout from '../layouts/Layout.astro';
import FeatureSection from '../components/FeatureSection.astro';
import Card from '../components/Card.astro';
import CardGrid from '../components/CardGrid.astro';
import ShareButtons from '../components/ShareButtons.astro';
import DemoCard from '../components/DemoCard.astro';
---

<Layout
  title="Project Story - The MEMoPAD Journey"
  description="Discover the story behind the MEMOPAD project, from its personal beginnings to its academic evolution. Learn how we are co-designing a digital tool to enhance mental health care through emotion recognition technology."
>
  <section class="page-hero">
    <div class="container">
      <div class="hero-image-container">
        <img src="/clinical_past.png" alt="A diagram showing clinical limitations and a digital solution pathway." />
      </div>
      <h1>Seeing the Gap, Building the Bridge</h1>
      <p class="subtitle">
        This is how a personal drive evolved into a PhD project exploring how emotion recognition technology can benefit mental health.
      </p>
    </div>
  </section>

  <section class="container acronym-section">
  <h2>What Does MEMoPAD Mean?</h2>
  
  <div class="animated-title" aria-label="MEMoPAD: Multimodal Emotion Monitoring in Clinical Pathways for Anxiety Disorders">
    <div class="acronym-breakdown">
      <div class="acronym-line">
        <span class="acronym-letter">M</span>
        <span class="acronym-text" data-text="ultimodal"></span>
      </div>
      <div class="acronym-line">
        <span class="acronym-letter">E</span>
        <span class="acronym-text" data-text="motion"></span>
      </div>
      <div class="acronym-line">
        <span class="acronym-letter">Mo</span>
        <span class="acronym-text" data-text="nitoring"></span>
      </div>
      <div class="acronym-line">
        <span class="acronym-text" data-text="in Clinical"></span>
      </div>
      <div class="acronym-line">
        <span class="acronym-letter">P</span>
        <span class="acronym-text" data-text="athways for"></span>
      </div>
      <div class="acronym-line">
        <span class="acronym-letter">A</span>
        <span class="acronym-text" data-text="nxiety"></span>
      </div>
      <div class="acronym-line">
        <span class="acronym-letter">D</span>
        <span class="acronym-text" data-text="isorders"></span>
      </div>
    </div>
  </div>
</section>

  <FeatureSection
    title="The Spark: A Personal Mission"
    theme="light"
    imagePosition="left"
    imageSrc="https://assets.publishing.service.gov.uk/media/5c66eb7fe5274a72bbe5fd36/Infographic_-_mental_health_rates.jpg"
    imageAlt="NHS infographic showing statistics on wellbeing and mental health in the UK."
    linkUrl="https://digital.nhs.uk/data-and-information/publications/statistical/adult-psychiatric-morbidity-survey/adult-psychiatric-morbidity-survey-survey-of-mental-health-and-wellbeing-england-2014"
    linkTitle="View the full NHS Adult Psychiatric Morbidity Survey"
  >
    <p>
      I'm <a href=`/contact`>Luigi A. Moretti MD, MSc in HealthTech</a> and this journey began with a personal truth: watching loved ones navigate the complexities of mental healthcare. Faced with their long-term struggles and <b>feeling powerless</b> to help despite my medical background, I saw <b>a clear and urgent need</b> for better tools and a more empathetic system, an opportunity to make a meaningful difference that could not be ignored.
      <small class="click-prompt">(Click the image to view the NHS article)</small>
    </p>
  </FeatureSection>

  <FeatureSection
    title="From Startup to Science"
    theme="dark"
    imagePosition="right"
    imageSrc="https://www.eleganzadelgusto.com/wordpress/wp-content/uploads/2017/11/ot11b51mod-1024x578.jpg"
    imageAlt="Video thumbnail for the IntelliHearts mobile app emotion recognition demo."
    linkUrl="https://www.youtube.com/watch?v=zCHwg8tJSfg?rel=0"
    linkTitle="Watch the IntelliHearts app demo on YouTube"
  >
    <p>
      The first step was a feature for my previous startup, IntelliHearts (with Lorenzo Diomeda & Dr Vincenzo Dentamaro): a one-lead ECG emotion recognition tool designed to increase the involvement of users and reduce the high drop-off rates common in digital health apps. Unexpectedly, <b>the feature generated more excitement than the core product</b>, with users, investors, and experts all highlighting its standalone potential for clinical use.
      <small class="click-prompt">(Click the image to watch the demo)</small>
    </p>
  </FeatureSection>

  <FeatureSection
    title="The PhD Project"
    theme="light"
    imagePosition="left"
    imageSrc="https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/UWE_Bristol_logo.svg/640px-UWE_Bristol_logo.svg.png"
    imageAlt="The official logo for UWE Bristol, the university hosting the MEMoPAD project."
    linkUrl="https://www.uwe.ac.uk/research/centres-and-groups/reach/members#section-5"
    linkTitle="Visit the official UWE Bristol research project page"
  >
    <p>
      This spark of interest led me to pursue the idea with <b>academic rigor and scientific scrutiny</b>. During my MSc, my project supervisor, David Western, and viva examiner, Michael Loizou, saw the potential and encouraged my application for a PhD scholarship at UWE Bristol. With their support, and now joined by the multidisciplinary expertise of Miles and Paul, this research was born.
      <small class="click-prompt">(Click the image to go to the UWE Bristol project website)</small>
    </p>
  </FeatureSection>
  
  <section id="team-section" class="team-section">
    <div class="container">
      <h2>Supervisory Team</h2>
      <p class="subtitle">The expert team providing invaluable guidance for this project.</p>
      <CardGrid>
        <Card name="Dr David Western" title="Director of Studies" imgSrc="https://uwe-repository.worktribe.com/avatar/792407?fit=0" imgAlt="Photo of David Western UWE Bristol" expertise="Artificial intelligence and smart sensing in health" linkUrl="https://uwe-repository.worktribe.com/person/792407/david-western" />
        <Card name="Dr Michael Loizou" title="Supervisor" imgSrc="https://uwe-repository.worktribe.com/avatar/8058351?fit=0" imgAlt="Photo of Michael Loizou UWE Bristol" expertise="Affective computing implementations in health" linkUrl="https://uwe-repository.worktribe.com/person/8058351/michael-loizou" />
        <Card name="Dr Miles Thompson" title="Supervisor" imgSrc="https://uwe-repository.worktribe.com/avatar/696945" imgAlt="Photo of Miles Thompson UWE Bristol" expertise="Clinical psychology" linkUrl="https://uwe-repository.worktribe.com/index.php/person/696945/miles-thompson" />
        <Card name="Dr Paul Matthews" title="Supervisor" imgSrc="https://uwe-repository.worktribe.com/avatar/434419?fit=0" imgAlt="Photo of Paul Matthews UWE Bristol" expertise="Data science and mobile apps in mental health" linkUrl="https://uwe-repository.worktribe.com/person/434419/paul-matthews" />
      </CardGrid>
    </div>
  </section>

  <FeatureSection
    title="From Startup to Science"
    theme="dark"
    imagePosition="right"
    imageSrc="/MEMoPAD-video-story.webp"
    imageAlt="Video thumbnail for a video story of MEMoPAD implemented in real life."
    linkUrl="https://youtu.be/9uJHqtzO6cw?rel=0"
    linkTitle="Watch how MEMoPAD can affect mental health care"
  >
    <p>
      Technology built in a vacuum often fails. Our foundation is <b>built on listening</b>. We use a co-design methodology, actively partnering with patients, clinicians, and carers at every stage. Their lived experiences and professional insights are not just feedback: they are the blueprint for building a tool that is truly <b>relevant, safe, and effective</b>.
      <small class="click-prompt">(Click the image to take part in our co-design!)</small>
    </p>
  </FeatureSection>

  <section class="page-outro">
    <div class="container">
      <h2>Work in Progress...</h2>
      <p>
        This project is an active and evolving journey. We are currently developing the initial prototype and preparing for the next phases of user testing and evaluation.
        <a href="/research/" class="outro-link">Learn more about our research and methodology.</a>
      </p>

      <div class="outro-demo-section">
        <h3>Latest MEMoPAD Demo</h3>
        <div class="demo-grid">
          <DemoCard
            title="Mobile App for Personal Use"
            description="Watch the latest trailer for our personal-use mobile application."
            videoId="_ZfFJO2GutQ"
          />
          <DemoCard
            title="Web App for Professionals"
            description="Explore the interactive prototype of the clinician-facing dashboard"
            linkUrl="https://memopad-demo.luigiandreamoretti.com/"
            imgSrc="/preview-demo-webapp.jpg"
          />
        </div>
      </div>
    </div>
  </section>

  <div class="container share-wrapper">
    <ShareButtons 
      pageTitle="The MEMoPAD Journey: A PhD Project Story"
      shareDescription="In the MEMOPAD project, Luigi A. Moretti and his supervisory team are co-designing a digital tool for anxiety disorders that uses technology to understand and measure emotional responses..." 
    />
  </div>
</Layout>

<script>

    // Script for MEMoPAD typing animation
    const textSpans = Array.from(document.querySelectorAll('.acronym-text')) as HTMLElement[];
    if (textSpans.length > 0) {
      let isTyping = true;
      let currentLine = 0;
      let currentChar = 0;
      const type = () => {
        if (!isTyping) return;
        const span = textSpans[currentLine];
        const fullText = span.dataset.text || '';
        span.textContent = fullText.substring(0, currentChar + 1);
        span.classList.add('has-cursor');
        if (currentChar < fullText.length) {
          currentChar++;
          setTimeout(type, 50);
        } else {
          span.classList.remove('has-cursor');
          currentLine++;
          currentChar = 0;
          if (currentLine < textSpans.length) {
            setTimeout(type, 200);
          } else {
            isTyping = false;
            setTimeout(() => { isTyping = true; erase(); }, 10000);
          }
        }
      };
      const erase = () => {
        if (!isTyping) return;
        let lineToDelete = textSpans.length - 1;
        const eraseChar = () => {
          const span = textSpans[lineToDelete];
          const fullText = span.dataset.text || '';
          
          // Use a fallback to ensure textContent is treated as a string
          span.textContent = fullText.substring(0, (span.textContent || '').length - 1);
          span.classList.add('has-cursor');
          if ((span.textContent || '').length > 0) {
            setTimeout(eraseChar, 30);
          } else {
            span.classList.remove('has-cursor');
            lineToDelete--;
            if (lineToDelete >= 0) {
              eraseChar();
            } else {
              isTyping = false;
              currentLine = 0;
              setTimeout(() => { isTyping = true; type(); }, 500);
            }
          }
        };
        eraseChar();
      };
      type();
    }
</script>


<style>
  /* --- STYLES FOR ANIMATED MEMoPAD --- */
  .sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
  }

  .animated-title {
    display: flex;
    justify-content: center;
    padding: 2rem 0;
  }
  .acronym-breakdown {
    text-align: left;
    font-size: 2rem;
    font-weight: 500;
    line-height: 1.6;
  }
  .acronym-line {
    display: flex;
    align-items: baseline;
  }
  .acronym-letter {
    color: var(--color-primary);
    font-weight: 700;
    padding-right: 0.4rem;
    min-width: 4rem;
    text-align: right;
  }
  .acronym-text {
    position: relative;
  }
  .acronym-text.has-cursor::after {
    content: '';
    position: absolute;
    right: -0.2em;
    top: 0.1em;
    bottom: 0.1em;
    width: 2px;
    background: var(--color-text);
    animation: blink 1s steps(1) infinite;
  }
  @keyframes blink { 50% { opacity: 0; } }
  
  @media (min-width: 768px) {
    .acronym-breakdown {
      font-size: 2.5rem;
    }
  }


  .team-section { padding: 4rem 2rem; background-color: var(--color-background); text-align: center; }
  .team-section h2 { font-size: 2.5rem; margin-bottom: 0.5rem; }
  .team-section .subtitle, .page-hero .subtitle { font-size: 1.125rem; color: var(--color-text-muted); margin-bottom: 3rem; max-width: 600px; margin-left: auto; margin-right: auto; }
  
  .page-hero {
    /* UPDATED: Reduced bottom padding */
    padding: 4rem 2rem 2rem; 
    text-align: center;
    background-color: var(--color-white);
  }
  .hero-image-container {
    max-width: 500px;
    margin: 0 auto 2rem;
  }
  .hero-image-container img {
    width: 100%;
    height: auto;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }
  .page-hero h1 {
    margin-top: 2rem;
  }
  
  .page-outro { padding: 4rem 2rem; text-align: center; background-color: var(--color-primary); color: var(--color-white); }
  .page-outro .container { padding-top: 0; padding-bottom: 0; }
  .page-outro h2 { color: var(--color-white); font-size: 2.5rem; margin-bottom: 1rem; }
  .page-outro p { max-width: 600px; margin-left: auto; margin-right: auto; font-size: 1.125rem; opacity: 0.9; }
  .outro-link { display: block; margin-top: 1.5rem; color: var(--color-white); font-weight: 700; opacity: 1; transition: opacity 0.2s ease; }
  .outro-link:hover { opacity: 0.8; }
  .click-prompt { display: block; margin-top: 1rem; font-style: italic; font-size: 0.9rem; color: var(--color-text-muted); }
  .share-wrapper { padding-top: 4rem; padding-bottom: 2rem; }
  .outro-demo-section { margin-top: 3rem; }
  .outro-demo-section h3 { font-size: 1.5rem; margin-bottom: 1.5rem; color: var(--color-white); }
  .demo-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; text-align: left; max-width: 1100px; margin: 0 auto; }
  @media (max-width: 900px) { .demo-grid { grid-template-columns: 1fr; } }
  .page-outro :global(.demo-card) { background-color: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); }
  .page-outro :global(.demo-card h3) { color: var(--color-white); }
  .page-outro :global(.demo-card .text-content p) { color: rgba(255, 255, 255, 0.9); }
</style>
